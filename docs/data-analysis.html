
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Analysis &#8212; Graupel-2</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="flight-path.html" />
    <link rel="prev" title="Graupel-2" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Graupel-2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Graupel-2
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data Analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/data-analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/sea7aero/graupel-2"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sea7aero/graupel-2/main?urlpath=tree/book/data-analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clean-up-the-data">
   Clean up the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#camera-shutoff">
   Camera Shutoff
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#altitude">
   Altitude
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correcting-the-barometric-altitude">
     Correcting the barometric altitude
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gps-altitude-noise">
     GPS altitude noise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#smoothing-noise">
   Smoothing noise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#altitude-statistics">
   Altitude statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-fun-data">
   Other Fun Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#horizontal-speed">
     Horizontal speed
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weather-data">
     Weather Data
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="data-analysis">
<h1>Data Analysis<a class="headerlink" href="#data-analysis" title="Permalink to this headline">¶</a></h1>
<p>Let’s take a look at what the data from the flight computer looks like. This data was recorded by an Arduino, logging telemetry once per second from the GPS and various sensors sensors and recorded them once a second.  More details and the source code of the flight computer can be located at <a class="reference external" href="https://github.com/sea7aero/horizon2">https://github.com/sea7aero/horizon2</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">preamble</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">150</span>

<span class="n">directory</span> <span class="o">=</span> <span class="s1">&#39;../data&#39;</span>

<span class="c1"># The flight tracker records invalid values as &quot;*&quot;, so we want to replace those with Not a Number (NaN).</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/raw-data.csv&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>millis</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>second</th>
      <th>voltage</th>
      <th>satellites</th>
      <th>hdop</th>
      <th>gps_altitude_m</th>
      <th>course</th>
      <th>speed_mps</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>temperature_C</th>
      <th>pressure_Pa</th>
      <th>pressure_altitude_m</th>
      <th>humidity_RH</th>
      <th>Unnamed: 19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1544</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.31</td>
      <td>93891.82</td>
      <td>638.10</td>
      <td>42.74</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2546</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.37</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.36</td>
      <td>93894.09</td>
      <td>637.90</td>
      <td>43.11</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3547</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.38</td>
      <td>93892.00</td>
      <td>638.09</td>
      <td>42.69</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4550</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.39</td>
      <td>93899.64</td>
      <td>637.41</td>
      <td>42.37</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5551</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.41</td>
      <td>93896.39</td>
      <td>637.70</td>
      <td>42.41</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="clean-up-the-data">
<h2>Clean up the data<a class="headerlink" href="#clean-up-the-data" title="Permalink to this headline">¶</a></h2>
<p>The raw data is a bit noisy - especially the first dozen seconds or so before the GPS acquired its lock - so the first step is to clean up the invalid data and a few other transformations in order to make it easier to work with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The tracker stores each part of the timestamp in a different column. To make it easier for us to work with and</span>
<span class="c1"># graph, we convert those columns into a single timestamp column, and make it the index of the Pandas dataframe.</span>
<span class="n">datetime_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;minute&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">]</span>
<span class="n">timestamps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">datetime_cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.0f}</span><span class="s2">-</span><span class="si">{:.0f}</span><span class="s2">-</span><span class="si">{:.0f}</span><span class="s2"> </span><span class="si">{:.0f}</span><span class="s2">:</span><span class="si">{:.0f}</span><span class="s2">:</span><span class="si">{:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">datetime_cols</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># The first few rows don&#39;t have a valid timestamp at all; we&#39;ll just get rid of them.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># # Fill any missing data with the last known value.  Then backfill missing data at the beginning of the file.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>

<span class="c1"># # Removes the extraneous &quot;unnamed&quot; column.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>millis</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>second</th>
      <th>voltage</th>
      <th>satellites</th>
      <th>hdop</th>
      <th>gps_altitude_m</th>
      <th>course</th>
      <th>speed_mps</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>temperature_C</th>
      <th>pressure_Pa</th>
      <th>pressure_altitude_m</th>
      <th>humidity_RH</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-25 17:26:17</th>
      <td>21594</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>26.0</td>
      <td>17.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>656.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>47.160809</td>
      <td>-120.84832</td>
      <td>19.56</td>
      <td>93893.46</td>
      <td>637.96</td>
      <td>42.33</td>
    </tr>
    <tr>
      <th>2021-09-25 17:26:18</th>
      <td>22598</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>26.0</td>
      <td>18.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>656.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>47.160809</td>
      <td>-120.84832</td>
      <td>19.56</td>
      <td>93896.89</td>
      <td>637.65</td>
      <td>42.08</td>
    </tr>
    <tr>
      <th>2021-09-25 17:26:19</th>
      <td>23600</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>26.0</td>
      <td>19.0</td>
      <td>4.37</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>656.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>47.160809</td>
      <td>-120.84832</td>
      <td>19.58</td>
      <td>93898.86</td>
      <td>637.48</td>
      <td>41.96</td>
    </tr>
    <tr>
      <th>2021-09-25 17:26:20</th>
      <td>24604</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>26.0</td>
      <td>20.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>656.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>47.160809</td>
      <td>-120.84832</td>
      <td>19.59</td>
      <td>93894.25</td>
      <td>637.89</td>
      <td>42.06</td>
    </tr>
    <tr>
      <th>2021-09-25 17:26:21</th>
      <td>25607</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>26.0</td>
      <td>21.0</td>
      <td>4.40</td>
      <td>0.0</td>
      <td>99.99</td>
      <td>656.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>47.160809</td>
      <td>-120.84832</td>
      <td>19.59</td>
      <td>93891.08</td>
      <td>638.17</td>
      <td>42.25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>That’s much better, but we turned the tracker on before launch, and that data is kind of boring, so let us compute some interesting time spans and crop our data to just the mission data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure out the launch time by when it starts ascending.</span>
<span class="n">ascent_rate</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">launch_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ascent_rate</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">launch_millis</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;millis&#39;</span><span class="p">][</span><span class="n">launch_index</span><span class="p">]</span>
<span class="n">launch_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">launch_index</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;mission_millis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;millis&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">launch_millis</span>

<span class="n">burst_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">])</span>
<span class="n">burst_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">burst_index</span><span class="p">]</span>

<span class="c1"># Figure out the landing time by when it stopped descending.</span>
<span class="n">landing_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascent_rate</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ascent_rate</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="n">landing_millis</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;millis&#39;</span><span class="p">][</span><span class="n">launch_index</span><span class="p">]</span>
<span class="n">landing_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">landing_index</span><span class="p">]</span> <span class="c1"># TODO: Determine this value, it may not be the last data.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Launch Time (UTC) : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">launch_time</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burst Time        : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">burst_time</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Landing Time      : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">landing_time</span><span class="p">))</span>

<span class="n">ascent_duration</span> <span class="o">=</span> <span class="n">burst_time</span> <span class="o">-</span> <span class="n">launch_time</span>
<span class="n">descent_duration</span> <span class="o">=</span> <span class="n">landing_time</span> <span class="o">-</span> <span class="n">burst_time</span>
<span class="n">mission_duration</span> <span class="o">=</span> <span class="n">ascent_duration</span> <span class="o">+</span> <span class="n">descent_duration</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission Duration  : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mission_duration</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ascent Duration   : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ascent_duration</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Descent Duration  : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">descent_duration</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Launch Time (UTC) : 2021-09-25 17:28:11
Burst Time        : 2021-09-25 20:04:25
Landing Time      : 2021-09-25 20:41:37
Mission Duration  : 0 days 03:13:26
Ascent Duration   : 0 days 02:36:14
Descent Duration  : 0 days 00:37:12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mission_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">launch_index</span><span class="p">:</span><span class="n">landing_index</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mission_data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>millis</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>second</th>
      <th>voltage</th>
      <th>satellites</th>
      <th>hdop</th>
      <th>gps_altitude_m</th>
      <th>course</th>
      <th>speed_mps</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>temperature_C</th>
      <th>pressure_Pa</th>
      <th>pressure_altitude_m</th>
      <th>humidity_RH</th>
      <th>mission_millis</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-25 20:41:33</th>
      <td>11728210</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>41.0</td>
      <td>33.0</td>
      <td>4.37</td>
      <td>12.0</td>
      <td>0.73</td>
      <td>364.4</td>
      <td>34.4</td>
      <td>4.8</td>
      <td>47.188889</td>
      <td>-119.438377</td>
      <td>23.58</td>
      <td>96866.77</td>
      <td>377.97</td>
      <td>31.80</td>
      <td>11593195</td>
    </tr>
    <tr>
      <th>2021-09-25 20:41:34</th>
      <td>11729211</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>41.0</td>
      <td>34.0</td>
      <td>4.37</td>
      <td>12.0</td>
      <td>0.79</td>
      <td>358.9</td>
      <td>51.6</td>
      <td>3.2</td>
      <td>47.188900</td>
      <td>-119.438339</td>
      <td>23.63</td>
      <td>96920.57</td>
      <td>373.33</td>
      <td>31.76</td>
      <td>11594196</td>
    </tr>
    <tr>
      <th>2021-09-25 20:41:35</th>
      <td>11730215</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>41.0</td>
      <td>35.0</td>
      <td>4.37</td>
      <td>12.0</td>
      <td>0.79</td>
      <td>353.4</td>
      <td>76.4</td>
      <td>2.6</td>
      <td>47.188892</td>
      <td>-119.438301</td>
      <td>23.68</td>
      <td>96992.07</td>
      <td>367.16</td>
      <td>31.70</td>
      <td>11595200</td>
    </tr>
    <tr>
      <th>2021-09-25 20:41:36</th>
      <td>11731216</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>41.0</td>
      <td>36.0</td>
      <td>4.37</td>
      <td>12.0</td>
      <td>0.90</td>
      <td>348.0</td>
      <td>97.6</td>
      <td>3.0</td>
      <td>47.188877</td>
      <td>-119.438271</td>
      <td>23.73</td>
      <td>97054.25</td>
      <td>361.80</td>
      <td>31.62</td>
      <td>11596201</td>
    </tr>
    <tr>
      <th>2021-09-25 20:41:37</th>
      <td>11732219</td>
      <td>2021.0</td>
      <td>9.0</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>41.0</td>
      <td>37.0</td>
      <td>4.37</td>
      <td>12.0</td>
      <td>0.75</td>
      <td>342.9</td>
      <td>112.1</td>
      <td>3.5</td>
      <td>47.188862</td>
      <td>-119.438232</td>
      <td>23.77</td>
      <td>97115.67</td>
      <td>356.50</td>
      <td>31.64</td>
      <td>11597204</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="camera-shutoff">
<h2>Camera Shutoff<a class="headerlink" href="#camera-shutoff" title="Permalink to this headline">¶</a></h2>
<p>In Graupel-1, we had a failure of the GoPro camera at around the Tropopause.  We determined this was due to the 16850 battery we were using to charge the GoPro getting cold, reducing its output voltage, and causing a shut off.</p>
<p>For Graupel-2, we used a large, commercial external battery bank to power both the GoPro and the flight computer. We insulated the battery with some foam and added a hand warmer for good measure.</p>
<p>It looks like it worked well to keep the battery above critical voltages:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;temperature_C&#39;</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Effect of temperature on voltage&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (C)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Voltage (V)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum temperature </span><span class="si">{</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;temperature_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">C&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum voltage </span><span class="si">{</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">V&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimum temperature -53.3C
Minimum voltage 4.13V
</pre></div>
</div>
<img alt="_images/data-analysis_8_1.png" src="_images/data-analysis_8_1.png" />
</div>
</div>
</div>
<div class="section" id="altitude">
<h2>Altitude<a class="headerlink" href="#altitude" title="Permalink to this headline">¶</a></h2>
<p>The next thing to look at is the altitude, of course. In our case, we have 2 sources of data for the altitude: the value reported by the GPS and a value derived from the barometric pressure sensor.  Let’s see what we’ve got…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[[</span><span class="s2">&quot;gps_altitude_m&quot;</span><span class="p">,</span> <span class="s2">&quot;pressure_altitude_m&quot;</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;altitude (meters)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;gps&quot;</span><span class="p">,</span> <span class="s2">&quot;barometric&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Raw altitude data&#39;</span><span class="p">)</span>

<span class="n">difference</span> <span class="o">=</span> <span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s2">&quot;gps_altitude_m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mission_data</span><span class="p">[</span><span class="s2">&quot;pressure_altitude_m&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum altitude discrepency: </span><span class="si">{</span><span class="n">difference</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> meters&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum altitude discrepency: 7005 meters
</pre></div>
</div>
<img alt="_images/data-analysis_10_1.png" src="_images/data-analysis_10_1.png" />
</div>
</div>
<div class="section" id="correcting-the-barometric-altitude">
<h3>Correcting the barometric altitude<a class="headerlink" href="#correcting-the-barometric-altitude" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://sea7aero.space/graupel-1">Graupel-1</a>, we learned that the tracker computes altitude from the barometric pressue using a naive algorithm that assumes you are in the Troposphere, which is the cause of the variation betweent he two readings.  Let’s go ahead and apply what we learned there to this data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here, we&#39;re loading up the ISA atmopsheric conditions and defining some constants.</span>
<span class="n">isa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/standard-atmosphere.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;base_pressure_Pa&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">annotate_layers</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_layer</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">isa</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">max_layer</span><span class="p">):</span>
            <span class="n">altitude</span><span class="o">=</span><span class="n">layer</span><span class="p">[</span><span class="s1">&#39;geopotential_altitude_m&#39;</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">altitude</span><span class="o">+</span><span class="mi">400</span><span class="p">,</span> <span class="n">layer</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis_transform</span><span class="p">())</span>
        
<span class="n">display</span><span class="p">(</span><span class="n">isa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>geopotential_altitude_m</th>
      <th>geometric_altitude_m</th>
      <th>lapse_rate_K_m</th>
      <th>base_temperature_C</th>
      <th>base_temperature_K</th>
      <th>base_pressure_Pa</th>
      <th>base_density_kg_m3</th>
    </tr>
    <tr>
      <th>layer</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>Mesopause</td>
      <td>84852</td>
      <td>86000</td>
      <td>NaN</td>
      <td>-86.28</td>
      <td>186.87</td>
      <td>0.37</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mesosphere</td>
      <td>71000</td>
      <td>71802</td>
      <td>-0.0020</td>
      <td>-58.50</td>
      <td>214.65</td>
      <td>3.96</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mesosphere</td>
      <td>51000</td>
      <td>51413</td>
      <td>-0.0028</td>
      <td>-2.50</td>
      <td>270.65</td>
      <td>66.94</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Stratopause</td>
      <td>47000</td>
      <td>47350</td>
      <td>0.0000</td>
      <td>-2.50</td>
      <td>270.65</td>
      <td>110.91</td>
      <td>0.0020</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Stratosphere</td>
      <td>32000</td>
      <td>32162</td>
      <td>0.0028</td>
      <td>-44.50</td>
      <td>228.65</td>
      <td>868.02</td>
      <td>0.0132</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stratosphere</td>
      <td>20000</td>
      <td>20063</td>
      <td>0.0010</td>
      <td>-56.50</td>
      <td>216.65</td>
      <td>5474.90</td>
      <td>0.0880</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tropopause</td>
      <td>11000</td>
      <td>11019</td>
      <td>0.0000</td>
      <td>-56.50</td>
      <td>216.65</td>
      <td>22632.00</td>
      <td>0.3639</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Troposphere</td>
      <td>-610</td>
      <td>-611</td>
      <td>-0.0065</td>
      <td>19.00</td>
      <td>292.15</td>
      <td>108900.00</td>
      <td>1.2985</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">universal_gas_constant</span> <span class="o">=</span> <span class="mf">8.31432</span> <span class="c1"># R, N*m/mol*K</span>
<span class="n">molar_mass_dry_air</span> <span class="o">=</span> <span class="mf">0.0289644</span> <span class="c1"># M, kg/mol</span>
<span class="n">gas_constant_dry_air</span> <span class="o">=</span> <span class="n">universal_gas_constant</span> <span class="o">/</span> <span class="n">molar_mass_dry_air</span>
<span class="n">gravitational_acceleration</span> <span class="o">=</span> <span class="mf">9.80665</span> <span class="c1"># g0, m/s^2</span>
<span class="c1"># R / g0 * M</span>
<span class="n">altitude_constants</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">gas_constant_dry_air</span> <span class="o">/</span> <span class="n">gravitational_acceleration</span>

<span class="k">def</span> <span class="nf">calc_altitude</span><span class="p">(</span><span class="n">pressure</span><span class="p">):</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">isa</span><span class="p">[</span><span class="s1">&#39;base_pressure_Pa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
    <span class="n">base_altitude</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;geopotential_altitude_m&#39;</span><span class="p">]</span>
    <span class="n">base_temperature</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;base_temperature_K&#39;</span><span class="p">]</span>
    <span class="n">pressure_ratio</span> <span class="o">=</span> <span class="n">pressure</span> <span class="o">/</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;base_pressure_Pa&#39;</span><span class="p">]</span>
    <span class="n">lapse_rate</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lapse_rate_K_m&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">lapse_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">altitude_constants</span> <span class="o">*</span> <span class="n">base_temperature</span> 
        <span class="k">return</span> <span class="n">base_altitude</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">base_temperature</span> <span class="o">/</span> <span class="n">lapse_rate</span>
        <span class="n">exponent</span> <span class="o">=</span> <span class="n">altitude_constants</span> <span class="o">*</span> <span class="n">lapse_rate</span>
        <span class="k">return</span> <span class="n">base_altitude</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">calc_altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">calc_altitude</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From: https://commons.erau.edu/cgi/viewcontent.cgi?article=1124&amp;context=ijaaa</span>
<span class="k">def</span> <span class="nf">calc_altitude_temp_adjusted</span><span class="p">(</span><span class="n">pressure_Pa</span><span class="p">,</span> <span class="n">temperature_C</span><span class="p">):</span>
    <span class="n">temperature_K</span> <span class="o">=</span> <span class="n">temperature_C</span> <span class="o">+</span> <span class="mf">273.15</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">isa</span><span class="p">[</span><span class="s1">&#39;base_pressure_Pa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">pressure_Pa</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
    
    <span class="n">base_altitude_m</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;geopotential_altitude_m&#39;</span><span class="p">]</span>
    <span class="n">base_temperature_K</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;base_temperature_K&#39;</span><span class="p">]</span>
    <span class="n">temp_ratio</span> <span class="o">=</span> <span class="n">base_temperature_K</span> <span class="o">/</span> <span class="n">temperature_K</span>
    
    <span class="n">pressure_ratio</span> <span class="o">=</span> <span class="n">pressure_Pa</span> <span class="o">/</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;base_pressure_Pa&#39;</span><span class="p">]</span>
    
    <span class="n">density_ratio</span> <span class="o">=</span> <span class="n">pressure_ratio</span> <span class="o">*</span> <span class="n">temp_ratio</span>
    <span class="n">lapse_rate</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lapse_rate_K_m&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">lapse_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">altitude_constants</span> <span class="o">*</span> <span class="n">base_temperature_K</span>
        <span class="k">return</span> <span class="n">base_altitude_m</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">density_ratio</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">base_temperature_K</span> <span class="o">/</span> <span class="n">lapse_rate</span>
        <span class="n">exponent</span> <span class="o">=</span> <span class="n">altitude_constants</span> <span class="o">*</span> <span class="n">lapse_rate</span>
        <span class="k">return</span> <span class="n">base_altitude_m</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">density_ratio</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">calc_altitude_temp_adjusted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">calc_altitude_temp_adjusted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calc_altitude_blended</span><span class="p">(</span><span class="n">pressure_Pa</span><span class="p">,</span> <span class="n">temperature_C</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pressure_Pa</span> <span class="o">&gt;</span> <span class="mi">22632</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">calc_altitude</span><span class="p">(</span><span class="n">pressure_Pa</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">calc_altitude_temp_adjusted</span><span class="p">(</span><span class="n">pressure_Pa</span><span class="p">,</span> <span class="n">temperature_C</span><span class="p">)</span>
    
<span class="n">calc_altitude_blended</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">calc_altitude_blended</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;blended_altitude_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_altitude_blended</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;pressure_Pa&#39;</span><span class="p">],</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;temperature_C&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[[</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">,</span> <span class="s1">&#39;blended_altitude_m&#39;</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;altitude (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;gps&quot;</span><span class="p">,</span> <span class="s2">&quot;better barometric&quot;</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temperature adjusted altitude&quot;</span><span class="p">)</span>

<span class="n">difference</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="s2">&quot;gps_altitude_m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mission_data</span><span class="p">[</span><span class="s2">&quot;blended_altitude_m&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum altitude discrepency: </span><span class="si">{</span><span class="n">difference</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> meters&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum altitude discrepency: 1046 meters
</pre></div>
</div>
<img alt="_images/data-analysis_16_1.png" src="_images/data-analysis_16_1.png" />
</div>
</div>
</div>
<div class="section" id="gps-altitude-noise">
<h3>GPS altitude noise<a class="headerlink" href="#gps-altitude-noise" title="Permalink to this headline">¶</a></h3>
<p>Okay, now the barometric altitude looks better, but what about those weird jags in the GPS data?  Those were not there in the Graupel-1 launch.  Let’s take a closer look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_window</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">locator</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">MinuteLocator</span><span class="p">(</span><span class="n">byminute</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">ConciseDateFormatter</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">][</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        
<span class="n">plot_window</span><span class="p">(</span><span class="s1">&#39;At launch&#39;</span><span class="p">,</span> <span class="n">launch_time</span><span class="p">,</span> <span class="n">launch_time</span> <span class="o">+</span> <span class="n">window</span><span class="p">)</span>
<span class="n">plot_window</span><span class="p">(</span><span class="s1">&#39;Before burst&#39;</span><span class="p">,</span> <span class="n">burst_time</span> <span class="o">-</span> <span class="n">window</span><span class="p">,</span> <span class="n">burst_time</span><span class="p">)</span>
<span class="n">plot_window</span><span class="p">(</span><span class="s1">&#39;After burst&#39;</span><span class="p">,</span> <span class="n">burst_time</span><span class="p">,</span> <span class="n">burst_time</span> <span class="o">+</span> <span class="n">window</span><span class="p">)</span>
<span class="n">plot_window</span><span class="p">(</span><span class="s1">&#39;At landing&#39;</span><span class="p">,</span> <span class="n">landing_time</span> <span class="o">-</span> <span class="n">window</span><span class="p">,</span> <span class="n">landing_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data-analysis_18_0.png" src="_images/data-analysis_18_0.png" />
<img alt="_images/data-analysis_18_1.png" src="_images/data-analysis_18_1.png" />
<img alt="_images/data-analysis_18_2.png" src="_images/data-analysis_18_2.png" />
<img alt="_images/data-analysis_18_3.png" src="_images/data-analysis_18_3.png" />
</div>
</div>
</div>
</div>
<div class="section" id="smoothing-noise">
<h2>Smoothing noise<a class="headerlink" href="#smoothing-noise" title="Permalink to this headline">¶</a></h2>
<p>The noise in the GPS altitude is still a mystery to me.  It seems that roughly every 4 minutes, through the entire flight, the GPS fails to update its altitude.  It does not appear to be correlated to any other data as far as I can tell. If anyone has an idea, I’d love to hear it.</p>
<p>However, we can correct the data fairly well.</p>
<p>The first thing we can do is simply discard the obvious outliers where the GPS data was dropped using a “hampel” filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hampel</span> <span class="kn">import</span> <span class="n">hampel</span>

<span class="n">filtered_altitude</span> <span class="o">=</span> <span class="n">hampel</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">],</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">imputation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;gps_altitude_m&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;unfiltered&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">filtered_altitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data-analysis_20_0.png" src="_images/data-analysis_20_0.png" />
</div>
</div>
<p>Next we can detect the discrepencies pretty easily by noting that the difference between one data point and the next is exactly 0.  This happens rather rarely in real data, so we can simply throw those data points out and interpolate to fill the gaps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replaces data points where the differences is 0 with NaN.</span>
<span class="n">reject_noise</span> <span class="o">=</span> <span class="n">filtered_altitude</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">filtered_altitude</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Fill those NaNs through linear interpolation.</span>
<span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reject_noise</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Smoothed altitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;altitude (m)&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ascent rate (m/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;ascent rate (m/s)&#39;)
</pre></div>
</div>
<img alt="_images/data-analysis_22_1.png" src="_images/data-analysis_22_1.png" />
</div>
</div>
<p>Alright, that looks pretty reasonable, though with some fairly rough nosie during a portion of the descent phase.</p>
</div>
<div class="section" id="altitude-statistics">
<h2>Altitude statistics<a class="headerlink" href="#altitude-statistics" title="Permalink to this headline">¶</a></h2>
<p>Finally, we can now compute some interesting altitude statistics and use them to answer some questions about our mission.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">burst_altitude_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">])</span>
<span class="n">burst_altitude_m</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="n">burst_altitude_ft</span> <span class="o">=</span> <span class="n">burst_altitude_m</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">ft</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Burst altitude: </span><span class="si">{</span><span class="n">burst_altitude_m</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> meters, (</span><span class="si">{</span><span class="n">burst_altitude_ft</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> feet)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Burst altitude: 33502.8 meters, (109917.3 feet)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can smooth out a bit of the noise in the ascent rate data with a simple exponential moving average.</span>
<span class="n">ascent_rate</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ascent_rate</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">])</span>

<span class="n">ascent_phase</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="n">mission_data</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">burst_time</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">descent_phase</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="n">mission_data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">burst_time</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum ascent rate: </span><span class="si">{0:0.2f}</span><span class="s2"> m/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ascent_phase</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average ascent rate: </span><span class="si">{0:0.2f}</span><span class="s2"> m/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ascent_phase</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum descent rate: </span><span class="si">{0:0.2f}</span><span class="s2"> m/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">descent_phase</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average descent rate: </span><span class="si">{0:0.2f}</span><span class="s2"> m/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">descent_phase</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ascent rate at landing: </span><span class="si">{0:0.2f}</span><span class="s2"> m/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">descent_phase</span><span class="p">[</span><span class="s1">&#39;ascent_rate_mps&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum ascent rate: 6.36 m/s
Average ascent rate: 3.53 m/s

Maximum descent rate: 60.84 m/s
Average descent rate: 14.91 m/s
Ascent rate at landing: 4.87 m/s
</pre></div>
</div>
<img alt="_images/data-analysis_26_1.png" src="_images/data-analysis_26_1.png" />
</div>
</div>
</div>
<div class="section" id="other-fun-data">
<h2>Other Fun Data<a class="headerlink" href="#other-fun-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="horizontal-speed">
<h3>Horizontal speed<a class="headerlink" href="#horizontal-speed" title="Permalink to this headline">¶</a></h3>
<p>In Graupel-1, our balloon reached horizontal speeds of up to 90 mph.  This time, our balloon strolled along a more leisurely pace.  This is good, because our ascent rate was lower than anticipated… if it was any faster, we would have had to drive to Idaho.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;speed_mps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;speed_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">annotate_layers</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_layer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;speed_mps&#39;</span><span class="p">],</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">])</span>
<span class="c1">#ax.plot(descent_phase[&#39;speed_mps&#39;], descent_phase[&#39;altitude_m&#39;])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Speed at altitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;speed (m/s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;altitude (meters)&quot;</span><span class="p">)</span>

<span class="n">mph</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">mile</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">hour</span>
<span class="n">max_speed</span> <span class="o">=</span> <span class="n">mission_data</span><span class="p">[</span><span class="s1">&#39;speed_mps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max speed: </span><span class="si">{</span><span class="n">max_speed</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mph</span><span class="p">)</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Max speed: 97.55 mile / hour
</pre></div>
</div>
<img alt="_images/data-analysis_29_1.png" src="_images/data-analysis_29_1.png" />
</div>
</div>
<p>From the above data, we can see why our balloon travelled so far east from its predicted flight path. Our original estimated ascent rate was 4.9 m/s, but since we ran out of helium before hitting our target lift, our actual ascent rate averaged only 3.9 m/s.  This caused our balloon to drift through the jet stream for a longer period of time, where it was being blown around at a brisk <strong>35 m/s (~80 mph)</strong>!</p>
</div>
<div class="section" id="weather-data">
<h3>Weather Data<a class="headerlink" href="#weather-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">annotate_layers</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_layer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ascent_phase</span><span class="p">[</span><span class="s1">&#39;temperature_C&#39;</span><span class="p">],</span> <span class="n">ascent_phase</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ascent&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">descent_phase</span><span class="p">[</span><span class="s1">&#39;temperature_C&#39;</span><span class="p">],</span> <span class="n">descent_phase</span><span class="p">[</span><span class="s1">&#39;altitude_m&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;descent&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temperature at Altitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;altitude (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;temperature (C)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;temperature (C)&#39;)
</pre></div>
</div>
<img alt="_images/data-analysis_32_1.png" src="_images/data-analysis_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write the missison data back out to a csv file.</span>
<span class="n">mission_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/clean-data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Graupel-2</a>
    <a class='right-next' id="next-link" href="flight-path.html" title="next page">&lt;no title&gt;</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By SEA7 Aerospace<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>